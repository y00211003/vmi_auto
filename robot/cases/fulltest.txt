*** Settings ***
Library           vmi.robot.caseutil.Cases
Library           vmi.robot.vmilib.VMIInstanceFactory
Library           vmi.server.servermanager.ServerManager
Library           vmi.unia.uniamanager.UniaManager

*** Variables ***
${full_active_code}        MW-DSCG-NWQ4Q-9JK24-RC6H6-JK4UJ-LNPQD    # Full Active Code
${trail_expired_active_code}    MW-6TZR-6HAWX-SFWX9-NP99P-86WEK-RJL7P    # Expired trail license

*** Test Cases ***
active_license_expired_trail
    [Setup]    Setup    management    active_license_expired_trail
    ${server}    build_instance    Server
    ${sm}    build_instance    ServerManager
    ${e_m}    Run Keyword And Expect Error    *    call_method    ${sm}    active_license    ${server}
    ...    ${trail_expired_active_code}
    should_contain    ${e_m}    ValueError

active_license_not_expired_trail
    [Setup]    Setup    management    active_license_not_expired_trail
    ${server}    build_instance    Server
    ${sm}    build_instance    ServerManager
    call_method    ${sm}    active_license    ${server}    MW-76JR-LAAQH-HC7VU-RC5BN-2N2YY-32V5G

create_local_user_in_default_group
    [Setup]    Setup    management    create_local_user_in_default_group
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    ${g_id}    get_group_id_by_name    ${server}    Default
    create_user_in_group    ${server}    ${g_id}    user    pass    1

create_local_user_with_special_char
    [Setup]    Setup    management    create_local_user_with_special_char
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    ${g_id}    get_group_id_by_name    ${server}    Default
    ${e_m}    Run Keyword And Expect Error    *    create_user_in_group    ${server}    ${g_id}    user_^%$$@!
    ...    pass    1
    should_contain    ${e_m}    Failed to create user

create_local_user_with_chinese_charactors
    [Setup]    Setup    management    create_local_user_with_chinese_charactors
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    ${g_id}    get_group_id_by_name    ${server}    Default
    ${e_m}    Run Keyword And Expect Error    *    create_user_in_group    ${server}    ${g_id}    user_对象
    ...    pass    1
    should_contain    ${e_m}    Failed to create user

create_2_local_users_with_same_name
    [Setup]    Setup    management    create_2_local_users_with_same_name
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    ${g_id}    get_group_id_by_name    ${server}    Default
    create_user_in_group    ${server}    ${g_id}    user    pass    1
    ${e_m}    Run Keyword And Expect Error    *    create_user_in_group    ${server}    ${g_id}    user
    ...    pass    1
    should_contain    ${e_m}    ValueError

create_local_group
    [Setup]    Setup    management    create_local_group
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    ${group_id}    create_group    ${server}    group1

create_local_group_with_special_char
    [Setup]    Setup    management    create_local_group
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    ${group_id}    create_group    ${server}    group!@#

create_local_group_with_chinese_charactors
    [Setup]    Setup    management    create_local_group
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    ${group_id}    create_group    ${server}    group对象

create_local_user_in_group01
    [Setup]    Setup    management    create_local_user_in_group
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    ${g_id}    create_group    ${server}    group1
    create_user_in_group    ${server}    ${g_id}    user    pass    1

active_license_full01
    [Setup]    Setup    management    active_license_full01
    ${server}    build_instance    Server
    active_license    ${server}    MW-ECNQ-3GZ3Q-ZHXLH-FMDZT-G47F3-JH4AK

active_license_full02
    [Setup]    Setup    management    active_license_full01
    ${server}    build_instance    Server
    ${sm}    build_instance    ServerManager
    call_method    ${sm}    active_license    ${server}    ${full_active_code}

active_license_twice01
    [Setup]    Setup    management    active_license_twice01
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    ${e_m}    Run Keyword And Expect Error    *    active_license    ${server}    ${full_active_code}
    should_contain    ${e_m}    Fail to Active License

delete_local_user01
    [Setup]    Setup    management    delete_local_user01
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    ${g_id}    get_group_id_by_name    ${server}    Default
    ${u_id}    create_user_in_group    ${server}    ${g_id}    user    pass    1
    delete_user_by_id    ${server}    ${u_id}

create_profile01
    [Setup]    Setup    management    create_profile01
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    ${g_id}    get_group_id_by_name    ${server}    Default
    ${u_id}    create_user_in_group    ${server}    ${g_id}    user    pass    1
    ${p}    build_instance    Profile    test    test
    ${p_id}    create_profile    ${server}    ${p}

delete_profile01
    [Setup]    Setup    management    delete_profile01
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    ${g_id}    get_group_id_by_name    ${server}    Default
    ${u_id}    create_user_in_group    ${server}    ${g_id}    user    pass    1
    ${p}    build_instance    Profile    test    test
    ${p_id}    create_profile    ${server}    ${p}
    delete_profiles    ${server}    ${p_id}

assign_profile_on_group01
    [Setup]    Setup    management    assign_profile_on_group01
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    ${g_id}    get_group_id_by_name    ${server}    Default
    ${u_id}    create_user_in_group    ${server}    ${g_id}    user    pass    1
    ${p}    build_instance    Profile    test    test
    ${p_id}    create_profile    ${server}    ${p}
    assign_profile_on_group    ${server}    ${g_id}    ${p_id}

assign_profile_on_group02
    [Setup]    Setup    management    assign_profile_on_group02
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    ${g_id}    create_group    ${server}    group1
    ${u_id}    create_user_in_group    ${server}    ${g_id}    user    pass    -1
    ${p}    build_instance    Profile    test    test
    ${p_id}    create_profile    ${server}    ${p}
    assign_profile_on_group    ${server}    ${g_id}    ${p_id}

assign_profile_on_user01
    [Setup]    Setup    management    assign_profile_on_user01
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    ${g_id}    get_group_id_by_name    ${server}    Default
    ${u_id}    create_user_in_group    ${server}    ${g_id}    user    pass    1
    ${p}    build_instance    Profile    test    test
    ${p_id}    create_profile    ${server}    ${p}
    assign_profile_on_user    ${server}    ${u_id}    ${p_id}

delete_profile_assigned_user01
    [Setup]    Setup    management    assign_profile_on_user01
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    ${g_id}    get_group_id_by_name    ${server}    Default
    ${u_id}    create_user_in_group    ${server}    ${g_id}    user    pass    1
    ${p}    build_instance    Profile    test    test
    ${p_id}    create_profile    ${server}    ${p}
    assign_profile_on_user    ${server}    ${u_id}    ${p_id}

enable_active_directory01
    [Setup]    Setup    management    enable_active_directory01
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    set_active_directory    ${server}    10.64.1.54    389    trend\\gannicus_wang    \#efv5rdx

enable_active_directory02
    [Setup]    Setup    management    enable_active_directory02
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    set_active_directory    ${server}    10.206.139.99    389    vmi\\qa1    1234

change_active_directory01
    [Setup]    Setup    management    change_active_directory01
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    set_active_directory    ${server}    10.206.139.99    389    vmi\\qa1    1234
    set_active_directory    ${server}    10.64.1.54    389    trend\\gannicus_wang    \#efv5rdx

disable_active_directory01
    [Setup]    Setup    management    disable_active_directory01
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    set_active_directory    ${server}    10.64.1.54    389    trend\\gannicus_wang    \#efv5rdx
    disable_active_directory    ${server}

disable_active_directory_and_create_local_user01
    [Setup]    Setup    management    disable_active_directory_and_create_local_user01
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    set_active_directory    ${server}    10.64.1.54    389    trend\\gannicus_wang    \#efv5rdx
    disable_active_directory    ${server}
    ${g_id}    get_group_id_by_name    ${server}    Default
    create_user_in_group    ${server}    ${g_id}    user    pass    1

disable_active_directory_and_create_local_user02
    [Setup]    Setup    management    disable_active_directory_and_create_local_user02
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    set_active_directory    ${server}    10.64.1.54    389    trend\\gannicus_wang    \#efv5rdx
    disable_active_directory    ${server}
    ${g_id}    create_group    ${server}    group1
    create_user_in_group    ${server}    ${g_id}    user    pass    1

disable_active_directory_and_create_local_user03
    [Setup]    Setup    management    disable_active_directory_and_create_local_user03
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    ${g_id}    get_group_id_by_name    ${server}    Default
    create_user_in_group    ${server}    ${g_id}    user    pass    1
    set_active_directory    ${server}    10.64.1.54    389    trend\\gannicus_wang    \#efv5rdx
    disable_active_directory    ${server}
    ${g_id}    create_group    ${server}    group1
    create_user_in_group    ${server}    ${g_id}    user02    pass    1

disable_active_directory_and_create_local_user04
    [Setup]    Setup    management    disable_active_directory_and_create_local_user04
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    ${g_id}    get_group_id_by_name    ${server}    Default
    create_user_in_group    ${server}    ${g_id}    user    pass    1
    set_active_directory    ${server}    10.64.1.54    389    trend\\gannicus_wang    \#efv5rdx
    disable_active_directory    ${server}
    ${g_id}    create_group    ${server}    group1
    ${e_m}    Run Keyword And Expect Error    *    create_user_in_group    ${server}    ${g_id}    user
    ...    pass    1
    should_contain    ${e_m}    ValueError

enable_local_user
    [Setup]    Setup    managment    enable_local_user
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    ${g_id}    get_group_id_by_name    ${server}    Default
    ${user_id}    create_user_in_group    ${server}    ${g_id}    user    pass    1
    enable_user_by_id    ${server}    ${user_id}

disable_local_user
    [Setup]    Setup    management    disable_local_user
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    ${g_id}    get_group_id_by_name    ${server}    Default
    ${user_id}    create_user_in_group    ${server}    ${g_id}    user    pass    1
    disable_user_by_id    ${server}    ${user_id}

enable_ldap_user
    [Setup]    Setup    management    enable_ldap_user
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    set_active_directory    ${server}    10.64.1.54    389    trend\\gannicus_wang    \#efv5rdx
    import_group_or_users    ${server}    gannicus wang    Gannicus Wang (RD-CN)    person
    ${user_id}    get_user_id_by_name    ${server}    gannicus_wang
    enable_user_by_id    ${server}    ${user_id}

disable_ldap_user
    [Setup]    Setup    management    disable_ldap_user
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    set_active_directory    ${server}    10.64.1.54    389    trend\\gannicus_wang    \#efv5rdx
    import_group_or_users    ${server}    gannicus wang    Gannicus Wang (RD-CN)    person
    ${user_id}    get_user_id_by_name    ${server}    gannicus_wang
    disable_user_by_id    ${server}    ${user_id}

import_ldap_user01
    [Setup]    Setup    management    import_ldap_user01
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    set_active_directory    ${server}    10.64.1.54    389    trend\\gannicus_wang    \#efv5rdx
    import_group_or_users    ${server}    gannicus wang    Gannicus Wang (RD-CN)    person

import_ldap_user02
    [Setup]    Setup    management    import_ldap_user02
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    set_active_directory    ${server}    10.64.1.54    389    trend\\gannicus_wang    \#efv5rdx
    import_group_or_users    ${server}    gannicus wang    Gannicus Wang (RD-CN)    person
    import_group_or_users    ${server}    vmi    All of CN VMI QA Team    group

import_ldap_user03
    [Setup]    Setup    management    import_ldap_user03
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    set_active_directory    ${server}    10.64.1.54    389    trend\\gannicus_wang    \#efv5rdx
    import_group_or_users    ${server}    gannicus wang    Gannicus Wang (RD-CN)    person
    ${e_m}    Run Keyword And Expect Error    *    import_group_or_users    ${server}    gannicus wang    Gannicus Wang (RD-CN)
    ...    person
    should_contain    ${e_m}    is already imported

import_ldap_user04
    [Setup]    Setup    management    import_ldap_user04
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    set_active_directory    ${server}    10.64.1.54    389    trend\\gannicus_wang    \#efv5rdx
    import_group_or_users    ${server}    vmi    All of CN VMI QA Team    group

import_ldap_user05
    [Setup]    Setup    management    import_ldap_user05
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    set_active_directory    ${server}    10.64.1.54    389    trend\\gannicus_wang    \#efv5rdx
    import_group_or_users    ${server}    vmi    All of CN VMI QA Team    group
    ${e_m}    Run Keyword And Expect Error    *    import_group_or_users    ${server}    gannicus wang    Gannicus Wang (RD-CN)
    ...    person
    should_contain    ${e_m}    is already imported

unia_local_user_login
    [Setup]    Setup    unia    unia_local_user_login
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    ${g_id}    get_group_id_by_name    ${server}    Default
    ${user}    build_instance    User    test    pass    test@test.com    1
    create_user_in_group    ${server}    ${g_id}    test    pass    1
    ${android}    build_instance    Android
    ${droid_helper}    build_instance    DroidAPI
    call_method    ${droid_helper}    invoke_device    ${android}
    call_method    ${droid_helper}    login_server_without_remember_password    ${server}    ${user}
    call_method    ${droid_helper}    set_unia_lock_screen_none    ${user}
    call_method    ${droid_helper}    navigate_to_launcher

unia_local_user_login_set_auth_none
    [Setup]    Setup    unia    unia_local_user_login_set_auth_none
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    ${g_id}    get_group_id_by_name    ${server}    Default
    ${user}    build_instance    User    test    pass    test@test.com    1
    create_user_in_group    ${server}    ${g_id}    test    pass    1
    ${android}    build_instance    Android
    ${droid_helper}    build_instance    DroidAPI
    call_method    ${droid_helper}    invoke_device    ${android}
    call_method    ${droid_helper}    login_server_without_remember_password    ${server}    ${user}
    call_method    ${droid_helper}    set_unia_lock_screen_none    ${user}
    call_method    ${droid_helper}    navigate_to_launcher

unia_local_user_login_set_auth_pin
    [Setup]    Setup    unia    unia_local_user_login_set_auth_pin
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    ${g_id}    get_group_id_by_name    ${server}    Default
    ${user}    build_instance    User    test    pass    test@test.com    3
    ...    1234
    create_user_in_group    ${server}    ${g_id}    test    pass    1
    ${android}    build_instance    Android
    ${droid_helper}    build_instance    DroidAPI
    call_method    ${droid_helper}    invoke_device    ${android}
    call_method    ${droid_helper}    login_server_without_remember_password    ${server}    ${user}
    call_method    ${droid_helper}    set_unia_lock_screen_pin    ${user}
    call_method    ${droid_helper}    navigate_to_launcher

unia_local_user_login_set_auth_password
    [Setup]    Setup    unia    unia_local_user_login_set_auth_password
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    ${g_id}    get_group_id_by_name    ${server}    Default
    ${user}    build_instance    User    test    pass    test@test.com    4
    ...    qwer
    create_user_in_group    ${server}    ${g_id}    test    pass    1
    ${android}    build_instance    Android
    ${droid_helper}    build_instance    DroidAPI
    call_method    ${droid_helper}    invoke_device    ${android}
    call_method    ${droid_helper}    login_server_without_remember_password    ${server}    ${user}
    call_method    ${droid_helper}    set_unia_lock_screen_password    ${user}
    call_method    ${droid_helper}    navigate_to_launcher

unia_ldap_user_login
    [Setup]    Setup    unia    unia_ldap_user_login
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    set_active_directory    ${server}    10.64.1.54    389    trend\\gannicus_wang    \#efv5rdx
    import_group_or_users    ${server}    gannicus wang    Gannicus Wang (RD-CN)    person
    ${user}    build_instance    User    trend\\gannicus_wang    \#efv5rdx    gannicus_wang@trendmicro.com.cn    1
    ${android}    build_instance    Android
    ${droid_helper}    build_instance    DroidAPI
    call_method    ${droid_helper}    invoke_device    ${android}
    call_method    ${droid_helper}    login_server_without_remember_password    ${server}    ${user}
    call_method    ${droid_helper}    set_unia_lock_screen_none    ${user}
    call_method    ${droid_helper}    navigate_to_launcher

unia_ldap_user_login_set_auth_none
    [Setup]    Setup    unia    unia_ldap_user_login_set_auth_none
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    set_active_directory    ${server}    10.64.1.54    389    trend\\gannicus_wang    \#efv5rdx
    import_group_or_users    ${server}    gannicus wang    Gannicus Wang (RD-CN)    person
    ${user}    build_instance    User    trend\\gannicus_wang    \#efv5rdx    gannicus_wang@trendmicro.com.cn    1
    ${android}    build_instance    Android
    ${droid_helper}    build_instance    DroidAPI
    call_method    ${droid_helper}    invoke_device    ${android}
    call_method    ${droid_helper}    login_server_without_remember_password    ${server}    ${user}
    call_method    ${droid_helper}    set_unia_lock_screen_none    ${user}
    call_method    ${droid_helper}    navigate_to_launcher

unia_ldap_user_login_set_auth_pin
    [Setup]    Setup    unia    unia_ldap_user_login_set_auth_pin
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    set_active_directory    ${server}    10.64.1.54    389    trend\\gannicus_wang    \#efv5rdx
    import_group_or_users    ${server}    gannicus wang    Gannicus Wang (RD-CN)    person
    ${user}    build_instance    User    trend\\gannicus_wang    \#efv5rdx    gannicus_wang@trendmicro.com.cn    3
    ...    1234
    ${android}    build_instance    Android
    ${droid_helper}    build_instance    DroidAPI
    call_method    ${droid_helper}    invoke_device    ${android}
    call_method    ${droid_helper}    login_server_without_remember_password    ${server}    ${user}
    call_method    ${droid_helper}    set_unia_lock_screen_pin    ${user}
    call_method    ${droid_helper}    navigate_to_launcher

unia_ldap_user_login_set_auth_password
    [Setup]    Setup    unia    unia_ldap_user_login_set_auth_password
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    set_active_directory    ${server}    10.64.1.54    389    trend\\gannicus_wang    \#efv5rdx
    import_group_or_users    ${server}    gannicus wang    Gannicus Wang (RD-CN)    person
    ${user}    build_instance    User    trend\\gannicus_wang    \#efv5rdx    gannicus_wang@trendmicro.com.cn    4
    ...    qwer
    ${android}    build_instance    Android
    ${droid_helper}    build_instance    DroidAPI
    call_method    ${droid_helper}    invoke_device    ${android}
    call_method    ${droid_helper}    login_server_without_remember_password    ${server}    ${user}
    call_method    ${droid_helper}    set_unia_lock_screen_password    ${user}
    call_method    ${droid_helper}    navigate_to_launcher

unia_local_user_login_and_logout
    [Setup]    Setup    unia    unia_local_user_login_and_logout
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    ${g_id}    get_group_id_by_name    ${server}    Default
    ${user}    build_instance    User    test    pass    test@test.com    1
    create_user_in_group    ${server}    ${g_id}    test    pass    1
    ${android}    build_instance    Android
    ${droid_helper}    build_instance    DroidAPI
    call_method    ${droid_helper}    invoke_device    ${android}
    call_method    ${droid_helper}    login_server_without_remember_password    ${server}    ${user}
    call_method    ${droid_helper}    set_unia_lock_screen_none    ${user}
    call_method    ${droid_helper}    navigate_to_launcher
    call_method    ${droid_helper}    signout_from_launcher

unia_ldap_user_login_and_logout
    [Setup]    Setup    unia    unia_ldap_user_login_and_logout
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    set_active_directory    ${server}    10.64.1.54    389    trend\\gannicus_wang    \#efv5rdx
    import_group_or_users    ${server}    gannicus wang    Gannicus Wang (RD-CN)    person
    ${user}    build_instance    User    trend\\gannicus_wang    \#efv5rdx    gannicus_wang@trendmicro.com.cn    1
    ${android}    build_instance    Android
    ${droid_helper}    build_instance    DroidAPI
    call_method    ${droid_helper}    invoke_device    ${android}
    call_method    ${droid_helper}    login_server_without_remember_password    ${server}    ${user}
    call_method    ${droid_helper}    set_unia_lock_screen_none    ${user}
    call_method    ${droid_helper}    navigate_to_launcher
    call_method    ${droid_helper}    signout_from_launcher

unia_disable_local_user_and_login
    [Setup]    Setup    unia    unia_disable_local_user_and_login
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    ${g_id}    get_group_id_by_name    ${server}    Default
    ${user}    build_instance    User    test    pass    test@test.com    1
    ${user_id}    create_user_in_group    ${server}    ${g_id}    test    pass    1
    disable_user_by_id    ${server}    ${user_id}
    ${android}    build_instance    Android
    ${droid_helper}    build_instance    DroidAPI
    call_method    ${droid_helper}    invoke_device    ${android}
    call_method    ${droid_helper}    login_server_without_remember_password    ${server}    ${user}
    Comment    call_method    ${droid_helper}    navigate_to_launcher
    ${e_m}    Run Keyword And Expect Error    *    call_method    ${droid_helper}    set_unia_lock_screen_none    ${user}
    should_contain    ${e_m}    ValueError

unia_disable_local_user_and_enable_then_login
    [Setup]    Setup    unia    unia_disable_local_user_and_enable_then_login
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    ${g_id}    get_group_id_by_name    ${server}    Default
    ${user}    build_instance    User    test    pass    test@test.com    1
    ${user_id}    create_user_in_group    ${server}    ${g_id}    test    pass    1
    disable_user_by_id    ${server}    ${user_id}
    ${android}    build_instance    Android
    ${droid_helper}    build_instance    DroidAPI
    call_method    ${droid_helper}    invoke_device    ${android}
    call_method    ${droid_helper}    login_server_without_remember_password    ${server}    ${user}
    Comment    call_method    ${droid_helper}    navigate_to_launcher
    ${e_m}    Run Keyword And Expect Error    *    call_method    ${droid_helper}    set_unia_lock_screen_none    ${user}
    should_contain    ${e_m}    ValueError
    enable_user_by_id    ${server}    ${user_id}
    call_method    ${droid_helper}    reinvoke_device    ${android}
    call_method    ${droid_helper}    login_server_without_remember_password    ${server}    ${user}
    call_method    ${droid_helper}    set_unia_lock_screen_none    ${user}
    call_method    ${droid_helper}    navigate_to_launcher

unia_disable_ldap_user_and_login
    [Setup]    Setup    unia    unia_disable_ldap_user_and_login
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    set_active_directory    ${server}    10.64.1.54    389    trend\\gannicus_wang    \#efv5rdx
    import_group_or_users    ${server}    gannicus wang    Gannicus Wang (RD-CN)    person
    ${user_id}    get_user_id_by_name    ${server}    gannicus_wang
    ${user}    build_instance    User    trend\\gannicus_wang    \#efv5rdx    gannicus_wang@trendmicro.com.cn    1
    disable_user_by_id    ${server}    ${user_id}
    ${android}    build_instance    Android
    ${droid_helper}    build_instance    DroidAPI
    call_method    ${droid_helper}    invoke_device    ${android}
    call_method    ${droid_helper}    login_server_without_remember_password    ${server}    ${user}
    Comment    call_method    ${droid_helper}    navigate_to_launcher
    ${e_m}    Run Keyword And Expect Error    *    call_method    ${droid_helper}    set_unia_lock_screen_none    ${user}
    should_contain    ${e_m}    ValueError

unia_disable_ldap_user_and_enable_then_login
    [Setup]    Setup    unia    unia_disable_ldap_user_and_enable_then_login
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    set_active_directory    ${server}    10.64.1.54    389    trend\\gannicus_wang    \#efv5rdx
    import_group_or_users    ${server}    gannicus wang    Gannicus Wang (RD-CN)    person
    ${user_id}    get_user_id_by_name    ${server}    gannicus_wang
    ${user}    build_instance    User    trend\\gannicus_wang    \#efv5rdx    gannicus_wang@trendmicro.com.cn    1
    disable_user_by_id    ${server}    ${user_id}
    ${android}    build_instance    Android
    ${droid_helper}    build_instance    DroidAPI
    call_method    ${droid_helper}    invoke_device    ${android}
    call_method    ${droid_helper}    login_server_without_remember_password    ${server}    ${user}
    Comment    call_method    ${droid_helper}    navigate_to_launcher
    ${e_m}    Run Keyword And Expect Error    *    call_method    ${droid_helper}    set_unia_lock_screen_none    ${user}
    should_contain    ${e_m}    ValueError
    enable_user_by_id    ${server}    ${user_id}
    call_method    ${droid_helper}    reinvoke_device    ${android}
    call_method    ${droid_helper}    login_server_without_remember_password    ${server}    ${user}
    call_method    ${droid_helper}    set_unia_lock_screen_none    ${user}
    call_method    ${droid_helper}    navigate_to_launcher

unia_local_user_relogin_with_auth_none
    [Setup]    Setup    unia    unia_local_user_relogin_with_auth_none
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    ${g_id}    get_group_id_by_name    ${server}    Default
    ${user}    build_instance    User    test    pass    test@test.com    1
    create_user_in_group    ${server}    ${g_id}    test    pass    1
    ${android}    build_instance    Android
    ${droid_helper}    build_instance    DroidAPI
    call_method    ${droid_helper}    invoke_device    ${android}
    call_method    ${droid_helper}    login_server_without_remember_password    ${server}    ${user}
    call_method    ${droid_helper}    set_unia_lock_screen_none    ${user}
    call_method    ${droid_helper}    navigate_to_launcher
    call_method    ${droid_helper}    signout_from_launcher
    call_method    ${droid_helper}    login_server_without_input_server_address    ${server}    ${user}
    call_method    ${droid_helper}    navigate_to_launcher
    call_method    ${droid_helper}    signout_from_launcher

unia_local_user_relogin_with_auth_pin
    [Setup]    Setup    unia    unia_local_user_relogin_with_auth_pin
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    ${g_id}    get_group_id_by_name    ${server}    Default
    ${user}    build_instance    User    test    pass    test@test.com    3
    ...    1234
    create_user_in_group    ${server}    ${g_id}    test    pass    1
    ${android}    build_instance    Android
    ${droid_helper}    build_instance    DroidAPI
    call_method    ${droid_helper}    invoke_device    ${android}
    call_method    ${droid_helper}    login_server_without_remember_password    ${server}    ${user}
    call_method    ${droid_helper}    set_unia_lock_screen_pin    ${user}
    call_method    ${droid_helper}    navigate_to_launcher
    call_method    ${droid_helper}    signout_from_launcher
    call_method    ${droid_helper}    login_server_without_input_server_address    ${server}    ${user}
    call_method    ${droid_helper}    unlock_unia_with_pin    1234
    call_method    ${droid_helper}    navigate_to_launcher
    call_method    ${droid_helper}    signout_from_launcher

unia_local_user_relogin_with_auth_password
    [Setup]    Setup    unia    unia_local_user_relogin_with_auth_password
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    ${g_id}    get_group_id_by_name    ${server}    Default
    ${user}    build_instance    User    test    pass    test@test.com    4
    ...    qwer
    create_user_in_group    ${server}    ${g_id}    test    pass    1
    ${android}    build_instance    Android
    ${droid_helper}    build_instance    DroidAPI
    call_method    ${droid_helper}    invoke_device    ${android}
    call_method    ${droid_helper}    login_server_without_remember_password    ${server}    ${user}
    call_method    ${droid_helper}    set_unia_lock_screen_password    ${user}
    call_method    ${droid_helper}    navigate_to_launcher
    call_method    ${droid_helper}    signout_from_launcher
    call_method    ${droid_helper}    login_server_without_input_server_address    ${server}    ${user}
    call_method    ${droid_helper}    unlock_unia_with_password    qwer
    call_method    ${droid_helper}    navigate_to_launcher
    call_method    ${droid_helper}    signout_from_launcher

unia_ldap_user_login_with_auth_none
    [Setup]    Setup    unia    unia_ldap_user_login_with_auth_none
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    set_active_directory    ${server}    10.64.1.54    389    trend\\gannicus_wang    \#efv5rdx
    import_group_or_users    ${server}    gannicus wang    Gannicus Wang (RD-CN)    person
    ${user}    build_instance    User    trend\\gannicus_wang    \#efv5rdx    gannicus_wang@trendmicro.com.cn    1
    ${android}    build_instance    Android
    ${droid_helper}    build_instance    DroidAPI
    call_method    ${droid_helper}    invoke_device    ${android}
    call_method    ${droid_helper}    login_server_without_remember_password    ${server}    ${user}
    call_method    ${droid_helper}    set_unia_lock_screen_none    ${user}
    call_method    ${droid_helper}    navigate_to_launcher
    call_method    ${droid_helper}    signout_from_launcher
    call_method    ${droid_helper}    login_server_without_input_server_address    ${server}    ${user}
    call_method    ${droid_helper}    navigate_to_launcher
    call_method    ${droid_helper}    signout_from_launcher

unia_ldap_user_login_with_auth_pin
    [Setup]    Setup    unia    unia_ldap_user_login_with_auth_pin
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    set_active_directory    ${server}    10.64.1.54    389    trend\\gannicus_wang    \#efv5rdx
    import_group_or_users    ${server}    gannicus wang    Gannicus Wang (RD-CN)    person
    ${user}    build_instance    User    trend\\gannicus_wang    \#efv5rdx    gannicus_wang@trendmicro.com.cn    3
    ...    1234
    ${android}    build_instance    Android
    ${droid_helper}    build_instance    DroidAPI
    call_method    ${droid_helper}    invoke_device    ${android}
    call_method    ${droid_helper}    login_server_without_remember_password    ${server}    ${user}
    call_method    ${droid_helper}    set_unia_lock_screen_pin    ${user}
    call_method    ${droid_helper}    navigate_to_launcher
    call_method    ${droid_helper}    signout_from_launcher
    call_method    ${droid_helper}    login_server_without_input_server_address    ${server}    ${user}
    call_method    ${droid_helper}    unlock_unia_with_pin    1234
    call_method    ${droid_helper}    navigate_to_launcher
    call_method    ${droid_helper}    signout_from_launcher

unia_ldap_user_login_with_auth_password
    [Setup]    Setup    unia    unia_ldap_user_login_with_auth_password
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    set_active_directory    ${server}    10.64.1.54    389    trend\\gannicus_wang    \#efv5rdx
    import_group_or_users    ${server}    gannicus wang    Gannicus Wang (RD-CN)    person
    ${user}    build_instance    User    trend\\gannicus_wang    \#efv5rdx    gannicus_wang@trendmicro.com.cn    4
    ...    qwer
    ${android}    build_instance    Android
    ${droid_helper}    build_instance    DroidAPI
    call_method    ${droid_helper}    invoke_device    ${android}
    call_method    ${droid_helper}    login_server_without_remember_password    ${server}    ${user}
    call_method    ${droid_helper}    set_unia_lock_screen_password    ${user}
    call_method    ${droid_helper}    navigate_to_launcher
    call_method    ${droid_helper}    signout_from_launcher
    call_method    ${droid_helper}    login_server_without_input_server_address    ${server}    ${user}
    call_method    ${droid_helper}    unlock_unia_with_password    qwer
    call_method    ${droid_helper}    navigate_to_launcher
    call_method    ${droid_helper}    signout_from_launcher

unia_local_user_open_remote_view
    [Setup]    Setup    unia    unia_local_user_open_remote_view
    ${server}    build_instance    Server
    active_license    ${server}    ${full_active_code}
    ${g_id}    get_group_id_by_name    ${server}    Default
    ${user}    build_instance    User    test    pass    test@test.com    1
    create_user_in_group    ${server}    ${g_id}    test    pass    1
    ${android}    build_instance    Android
    ${droid_helper}    build_instance    DroidAPI
    call_method    ${droid_helper}    invoke_device    ${android}
    call_method    ${droid_helper}    login_server_without_remember_password    ${server}    ${user}
    call_method    ${droid_helper}    set_unia_lock_screen_none    ${user}
    call_method    ${droid_helper}    navigate_to_launcher
    call_method    ${droid_helper}    launch_app_from_unia    Settings
